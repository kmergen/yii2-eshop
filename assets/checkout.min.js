"use strict";KMeshop.checkout=function(o){var e={init:function(e){o.extend(a,e),i=document.getElementById(a.CHECKOUT_FORM_ID),t=document.getElementById(a.PAYMENT_WALL_ID),d=Stripe(a.stripeId,{betas:["payment_intent_beta_3"]}),s=d.elements(),o(i).on("beforeSubmit",function(e){return r(m(),"submit"),!1}),o(t).on("show.bs.collapse",function(e){var n=o(e.target);n.find(".spinner-border").removeClass("d-none"),o.ajax(n.data("paneurl")).done(function(e){n.find(".spinner-border").addClass("d-none"),n.children(a.PANE_CONTENT_SELECTOR).html(e.html);var t=n.data("paymentmethod");u(t),r(t,"add",e),o(i).yiiActiveForm("validateAttribute","checkoutform-paymentmethod")}).fail(function(){})}),o(t).on("hide.bs.collapse",function(e){var t=o(e.target),n=m();u(""),r(n,"remove"),t.children(a.PANE_CONTENT_SELECTOR).empty()}),o(document.getElementById(a.CANCEL_BUTTON_ID)).on("click",function(){document.getElementById(a.CHECKOUT_CANCELED_ID).value="1",i.submit()})}},a={active:!0,CHECKOUT_FORM_ID:"checkoutForm",PAYMENT_WALL_ID:"paymentWall",CANCEL_BUTTON_ID:"btnCancel",CHECKOUT_CANCELED_ID:"checkoutform-checkoutcanceled",PAYMENT_METHOD_ID:"checkoutform-paymentmethod",PANE_CONTENT_SELECTOR:".card-body",stripeId:void 0},i=void 0,t=void 0,d=void 0,s=void 0,c=void 0,l=void 0;function r(e,t,n){switch(e){case"paypal_rest":"add"===t||"remove"===t||"submit"===t&&i.submit();break;case"stripe_card":"add"===t?function(){void 0===l&&(l=s.create("card",{style:{base:{fontSize:"16px",color:"#32325d"}}}));l.mount("#stripeCardElement");var a=document.getElementById("stripeCardButton");a.addEventListener("click",function(e){var t=document.getElementById("card-cardholdername"),n=a.dataset.secret;d.handleCardPayment(n,l,{source_data:{owner:{name:t.value}}}).then(function(e){if(e.error);else;})}),l.addEventListener("change",function(e){var t=document.getElementById("stripeCardFormGroup"),n=document.getElementById("stripeCardErrors");e.error?(n.textContent=e.error.message,t.classList.add("is-invalid"),e.complete||t.classList.remove("is-valid")):(n.textContent="",t.classList.remove("is-invalid"),e.complete&&t.classList.add("is-valid"))})}():"remove"===t&&l.unmount();break;case"stripe_sepa":"add"===t?(!function(){void 0===c&&(c=s.create("iban",{style:{base:{color:"#32325d",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"},":-webkit-autofill":{color:"#32325d"}},invalid:{color:"#fa755a",iconColor:"#fa755a",":-webkit-autofill":{color:"#fa755a"}}},supportedCountries:["SEPA"]}));c.mount("#stripeIbanElement"),c.on("change",function(e){var t=document.getElementById("stripeIbanFormGroup"),n=document.getElementById("stripeIbanErrors"),a=document.getElementById("stripeBankName");e.error?(n.textContent=e.error.message,t.classList.add("is-invalid"),e.complete||t.classList.remove("is-valid")):(n.textContent="",t.classList.remove("is-invalid"),e.complete&&t.classList.add("is-valid")),e.bankName?(a.textContent=e.bankName,a.classList.add("d-block")):(a.classList.remove("d-block"),a.classList.add("d-none"))})}(),r=n.errorMessages,o(i).yiiActiveForm("add",{id:"sepa-bankaccountowner",name:"Sepa[bankaccountOwner]",container:".field-sepa-bankaccountowner",input:"#sepa-bankaccountowner",error:".invalid-feedback",validateOnBlur:!1,validate:function(e,t,n,a,o){yii.validation.required(t,n,{message:r.bankaccountOwner.required})}})):"remove"===t?c.unmount():"submit"===t&&(a={type:"sepa_debit",currency:"eur",owner:{name:document.querySelector('input[name="Sepa[bankaccountOwner]"]').value,email:"klaus.mergen@web.de"},mandate:{notification_method:"email"}},d.createSource(c,a).then(function(e){var t,n,a=document.getElementById("stripeIbanFormGroup"),o=document.getElementById("stripeIbanErrors");e.error?(o.textContent=e.error.message,a.classList.add("is-invalid")):(a.classList.remove("is-invalid"),t=e.source,(n=document.createElement("input")).setAttribute("type","hidden"),n.setAttribute("name","stripeSource"),n.setAttribute("value",t.id),i.appendChild(n))}));break;default:return}var a,r}function m(){return document.getElementById(a.PAYMENT_METHOD_ID).value}function u(e){document.getElementById(a.PAYMENT_METHOD_ID).value=e}return e}(jQuery);